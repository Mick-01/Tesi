from scipy.interpolate import CubicSpline
import numpy as np
import matplotlib.pyplot as plt

def interp(input, points):
    spl = CubicSpline(np.arange(input.shape[0]),input)
    x_out = np.linspace(0,k_input.shape[0]-1,points)
    return spl(x_out)

k_input = np.array([0.003958032090272496, 0.006326925226502312, 0.02973255808418568, 0.09712680855681595, 0.2201865114083399, 0.3787769869525308, 0.5375196333595593, 0.6749045691056911, 0.7867568840807763, 0.876541804615788, 0.9483507987804878, 1.0059568336502525, 1.0525379758704347, 1.0906252973575503, 1.1221786716496198, 1.1486925806451613, 1.171264280094414, 1.1906414023591088, 1.2073998032786886, 1.2219791147540984, 1.2347379344262295, 1.2459467758846656, 1.2558415409836066, 1.264605737704918, 1.2723870098360655, 1.2793072459016395, 1.2854589770491802, 1.2909564721311475, 1.2958447016393444, 1.300209586885246, 1.3040817901639343, 1.3075170754098362, 1.310555718032787, 1.313226544262295, 1.3155617704918032, 1.317584281967213, 1.3193108256880735, 1.3207730144167757, 1.321987980327869, 1.322948393442623, 1.323675586885246, 1.3241960327868854, 1.3245094032786886, 1.32462, 1.3245388196721313, 1.3242686557377048, 1.3238195737704919, 1.3231868459016394, 1.322386518032787, 1.321415737704918, 1.3202751803278687, 1.3189780327868852, 1.317506006557377, 1.315873180327869, 1.31408374836173, 1.3121227672131148, 1.3100037704918033, 1.3077233836065574, 1.305272773770492, 1.3026637311475409, 1.2998797509829618, 1.2969285836065574, 1.293808518032787, 1.290506236065574, 1.287030006557377, 1.2833777049180328, 1.279538537704918, 1.2755070491803278, 1.271280819672131, 1.266864737876802, 1.2622359016393443, 1.257405704918033, 1.252366137704918, 1.2471087581699347, 1.2416217647058823, 1.2359163157894735, 1.2299596052631578, 1.2237721710526317, 1.2173175163398693, 1.2106139215686273, 1.2036425, 1.196397908496732, 1.1888718954248365, 1.1810398039215686, 1.1729010526315788, 1.1644705921052632, 1.1557005263157893, 1.146603725490196, 1.1371605263157896, 1.12733, 1.1171014379084967, 1.1064190131578948, 1.0952529411764707, 1.083553947368421, 1.071285, 1.0584270588235294, 1.044940588235294, 1.0307814379084967, 1.015934640522876, 1.0003519607843137, 0.9840152941176471, 0.9668703790849674, 0.9488768104575164, 0.9300005526315789, 0.9101748157894738, 0.8893450392156862, 0.8674340526315789, 0.8443489999999999, 0.8199868421052632, 0.7942117450980392, 0.766871091503268, 0.7377964117647059, 0.7068389673202615, 0.6739392222222221, 0.6395747500000001, 0.604423197368421, 0.5688888039215687, 0.5334056249999999, 0.49843154901960796, 0.464408202614379, 0.43160513725490185, 0.3999540855263159, 0.36910423026315786, 0.3389626578947369, 0.30982331372549027, 0.28207196078431374, 0.25613237254901966, 0.23243505882352944, 0.2113461764705882, 0.19312097368421055, 0.17783439473684212, 0.16538672549019606, 0.15551444736842107, 0.14785691503267973, 0.14202037254901959, 0.13763080392156865, 0.13435577124183007, 0.13192046052631579, 0.1301102105263158, 0.1287827105263158, 0.127853625, 0.12722836842105265, 0.12681811842105262, 0.1265623137254902, 0.12641736842105264, 0.126355, 0.126355, 0.1264, 0.12647833986928106, 0.12658279738562092, 0.12670464052287583, 0.1268389411764706, 0.1269807960526316, 0.12712729411764706, 0.12727453289473684, 0.12742059477124185, 0.12756259210526316, 0.12769861842105265, 0.12782875, 0.1279511875, 0.12806493333333335, 0.128169, 0.128263875, 0.12835, 0.1284255625, 0.1284918, 0.128549, 0.128598, 0.128638, 0.128671, 0.128697, 0.128717, 0.128732, 0.128742, 0.128747])
omega_input = np.array([3261899.632038606, 829113.5941448379, 228546.70967741936, 106574.53869254475, 64827.019000786786, 45648.61815499607, 34829.48493968004, 27819.32609493837, 22889.27102019407, 19238.32391817467, 16437.953658536586, 14237.309507573274, 12475.807212641796, 11044.576978558784, 9865.67750065565, 8881.674301075269, 8048.8932894046675, 7336.8743905635665, 6722.121521311476, 6186.922196721311, 5717.408537704918, 5302.705399737877, 4934.131140983606, 4604.846393442624, 4309.080203278689, 4042.1902557377052, 3800.379337704918, 3580.3892655737704, 3379.545422950819, 3195.577704918033, 3026.568596721311, 2870.8468655737706, 2726.9661967213115, 2593.725613114754, 2470.046924590164, 2354.9849901639345, 2247.7277064220184, 2147.5777195281785, 2053.869698360656, 1966.053744262295, 1883.6207672131147, 1806.144426229508, 1733.2133180327867, 1664.464875491481, 1599.5799016393444, 1538.28, 1480.2940065573769, 1425.3814098360658, 1373.3293967213115, 1323.9403278688526, 1277.044524590164, 1232.467213114754, 1190.0637377049181, 1149.689737704918, 1111.2184665792922, 1074.5541180327868, 1039.5760655737706, 1006.1697639344262, 974.2735245901639, 943.7857016393443, 914.63250982962, 886.7402714754097, 860.0398019672131, 834.4714367213115, 809.9773180327869, 786.4999508196722, 763.9908131147541, 742.4003167213116, 721.686693114754, 701.8067581913499, 682.7222950819672, 664.397262295082, 646.7973226229508, 629.8876405228758, 613.6446862745097, 598.0330789473684, 583.0338552631579, 568.61225, 554.7561633986928, 541.433091503268, 528.6275, 516.3210849673203, 504.4957647058824, 493.13129411764703, 482.21097368421056, 471.72405263157896, 461.6533092105263, 451.9878954248366, 442.71260526315785, 433.802, 425.2320522875817, 416.967552631579, 408.992751633987, 401.2872105263158, 393.83151315789473, 386.60854901960784, 379.6047058823529, 372.80391503267975, 366.1926993464052, 359.7563986928105, 353.4789411764706, 347.34571895424835, 341.3362483660131, 335.43620394736837, 329.62023684210527, 323.8629607843137, 318.13456578947364, 312.39584313725493, 306.60263157894735, 300.69401960784313, 294.5980130718954, 288.2250588235294, 281.47490196078434, 274.28, 266.88125, 259.46506578947367, 251.92222875816998, 244.1571644736842, 236.12301960784316, 227.84546405228755, 219.36867320261436, 210.65676973684214, 201.54246052631578, 191.83784210526318, 181.43786274509807, 170.28178431372552, 158.37073856209153, 145.80121568627453, 132.7826470588235, 119.64286842105264, 106.78332894736845, 94.61620784313725, 83.47670263157897, 73.56822745098039, 64.95066862745097, 57.55761960784316, 51.21522679738562, 45.656206578947376, 40.560642105263156, 35.79988421052631, 31.765225, 28.63791184210526, 26.195065789473688, 24.24868431372549, 22.671857894736842, 21.376907236842108, 20.30163289473684, 19.40078815789474, 18.640464705882355, 17.994991503267975, 17.444630065359476, 16.97368235294118, 16.569730263157894, 16.222752941176473, 15.924540789473685, 15.668207843137255, 15.44808947368421, 15.259419736842105, 15.098025, 14.96025, 14.84324, 14.744137499999999, 14.6606625, 14.590766666666667, 14.5324875, 14.484259999999999, 14.4448, 14.412606666666665, 14.38678, 14.3662, 14.350181249999999, 14.338026666666666, 14.3292, 14.3235, 14.3206])
U_input = np.genfromtxt('U_in.csv', delimiter=",").transpose()

with open("interpolated inputs.txt","w") as f:
    f.write("k:\n")
    f.write(" ".join([str(i) for i in interp(k_input,132)]))
    f.write("\nomega:\n")
    f.write(" ".join([str(i) for i in interp(omega_input,132)]))
    U_out = np.array([interp(row, 132) for row in U_input]).transpose()
    U_out_str = " ".join(["( "+ " ".join([str(i) for i in row]) +" )"for row in U_out])
    f.write("\nU:\n")
    f.write(U_out_str)